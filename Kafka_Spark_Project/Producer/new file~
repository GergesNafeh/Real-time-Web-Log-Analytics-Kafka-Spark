from kafka import KafkaProducer

TOPIC_NAME = 'WEB-log'
KAFKA_SERVER = 'localhost:9092'

try:
    producer = KafkaProducer(
        bootstrap_servers=KAFKA_SERVER,
        value_serializer=lambda v: v.encode('utf-8')
    )
    print("✅ Producer created, sending test message...")
    
    producer.send(TOPIC_NAME, value="Hello Kafka!").get(timeout=10)
    print("✅ Test message sent successfully")
    
    producer.close()
except Exception as e:
    print("❌ Error:", e)
